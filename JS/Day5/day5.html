<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>async / await</title>
</head>

<body>
    <h1>Users</h1>
    <p class="msg"></p>
    <ul class="users"></ul>
    <script>
        /*function fetchData() {
            return new Promise((resolve, reject) => {
                setTimeout(() => {
                    resolve("Task Completed");
                }, 2000);
            });
        }
        fetchData().then(data => {
            console.log(data);
        })*/
        const msg = document.querySelector('.msg');
        const users = document.querySelector('.users');

        let count = 0;

        msg.innerText = "Loading users";

        const intervalId = setInterval(() => {
            msg.innerText += ".";
            count++;
            if (count === 3) {
                count = 0;
                msg.innerText = msg.innerText.slice(0, 13);
            }
        }, 500);

        async function fetchData() {
            try {
                const response = await fetch(
                    "https://jsonplaceholder.typicode.com/users"
                );

                if (!response.ok) {
                    throw new Error("Failed to fetch users");
                }

                const data = await response.json();

                clearInterval(intervalId);
                msg.innerText = "";

                users.innerHTML = "";

                data.forEach(user => {
                    const li = document.createElement("li");
                    li.textContent = `Name: ${user.name} | Email: ${user.email}`;
                    users.appendChild(li);
                });

            } catch (error) {
                clearInterval(intervalId);
                msg.innerText = "Failed to load users!";
                console.error(error);
            }
        }

        fetchData();
    </script>
</body>

</html>